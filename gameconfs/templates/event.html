{% extends "layout.html" %}
{% block title %}{{ event.name }} - Gameconfs{% endblock %}
{% block content %}
  <div itemscope itemtype="http://schema.org/Event">
    <h2 itemprop="name" id="event_name">{{ event.name }}</h2>
    <table class="table table-condensed event">
      <tbody>
        {% if event.start_date == event.end_date %}
        <tr>
          <td>Date</td>
          <td><span itemprop="startDate" id="event_date" content="{{ event.start_date|microdata_date }}">{{ event.start_date|nice_date }} {{ event.start_date.year }}</span>
          {% if event.start_date == today %}
          &nbsp;<span class="badge badge-today">TODAY</span>
          {% endif %}
          <span itemprop="endDate" content="{{ event.end_date|microdata_date }}"/>
          </td>
        </tr>
        {% else %}
        <tr>
          <td>Dates</td>
          <td><span itemprop="startDate" content="{{ event.start_date|microdata_date }}">{{ event.start_date|nice_date }}</span> until <span itemprop="endDate" content="{{ event.end_date|microdata_date }}">{{ event.end_date|nice_date }} {{ event.start_date.year }}</span>
          {% if event.start_date <= today and today <= event.end_date %}
          &nbsp;<span class="badge badge-today">TODAY</span>
          {% endif %}
          </td>
        </tr>
        {% endif %}
        <tr>
          <td>Website</td>
          {% if event.event_url %}
          <td><a itemprop="url" id="event_url" href="{{ event.event_url }}" target="_blank">{{ event.event_url }}</a></td>
          {% else %}
          <td>None</td>
          {% endif %}
        </tr>
        {% if event.twitter_hashtags %}
        <tr>
          <td>Twitter hashtags</td> 
          <td id="event_hashtags">
            {% for tag in event.twitter_hashtags|split %}
            <a href="http://twitter.com/search?q=%23{{ tag[1:]|urlencode }}" target="_blank">{{ tag }}</a>
            {% endfor %}
          </td>
        </tr>
        {% endif %}
        {% if event.twitter_account %}
        <tr>
          <td>Twitter account</td>
          <td><a id="event_twitter" href="http://twitter.com/{{ event.twitter_account|urlencode }}" target="_blank">@{{ event.twitter_account }}</a></td>
        </tr>
        {% endif %}
        <tr>
          <td>Location</td>
          <td itemprop="location">{{ event|event_location }}</td>
        </tr>
        {% if logged_in %}
        <tr class="info">
          <td>Created at</td>
          <td>{{ event.created_at|datetimeformat('%d %B %Y %H:%M') }}</td>
        </tr>
        <tr class="info">
          <td>Last modified at</td>
          <td>{{ event.last_modified_at|datetimeformat('%d %B %Y %H:%M') }}</td>
        </tr>
        {% endif %}
      </tbody>
    </table>
    <p>
        <a class="btn" href="{{ url_for('event_ics', id=event.id) }}"><i class="icon-calendar"></i>&nbsp;Add to calendar</a>&nbsp;{{ event|build_google_calendar_link|safe }}
        &nbsp;&nbsp;<small>(This feature is still in Alpha - <a href="mailto:admin@gameconfs.com">let me know</a> if you're having problems.)</small>
    </p>
    {% if logged_in %}
    <a class="btn" href="{{ url_for('edit_event', id=event.id) }}">Edit</a>
    <a class="btn btn-danger" id="delete-button" href="{{ url_for('delete_event', id=event.id) }}">Delete</a>
    {% endif %}
  </div>

<img style="opacity: 0;position: absolute;top:0; left:0" src="{{ url_for('static', filename='img/gameconfs_pinterest.jpg') }}">

{% endblock %}

{% if logged_in %}
{% block end_of_body %}
<script src="{{ url_for('static', filename='js/event-editing.js') }}"></script>
{% endblock %}
{% endif %}