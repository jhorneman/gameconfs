{% extends "layout.html" %}
{% block content %}
	<div class="dropdown">
	  <a class="dropdown-toggle" href="#" role="button" data-toggle="dropdown">{{ today.year }}</a>
	  <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
	  	{% for year in range(min_year, max_year+1) %}
	    <li><a tabindex="-1" href="{{ url_for('year', year=year) }}">{{ year }}</a></li>
	    {% endfor %}
	  </ul>
	</div>
	<ul class="months">
		{% for month in range(1, 12+1) %}
		<li class="month">
			<a href="#{{ month }}">{{ month|short_month }}</a>
		</li>
		{% endfor %}
	</ul>
	{% if events %}
	{% for year_group in events|sort(attribute='start_date')|groupby('start_date.year') %}
	{% for month_group in year_group.list|groupby('start_date.month') %}
	<a name="{{ month_group.grouper }}"></a>
	<h3>{{ month_group.grouper|nice_month }} {{ year_group.grouper }}</h3>
	<table class="table table-condensed events">
	  	<tbody>
		{% for event in month_group.list %}
    		<tr>
			{% if event.start_date <= today and today <= event.end_date %}
	      	<td><span class="badge badge-today">TODAY</span></td>
	      	{% else %}
		     	<td><span class="date">{{ event.start_date|nice_date }}</span><span class="short_date">{{ event.start_date|short_date }}</span></td>
	      	{% endif %}
	      	<td><a href="{{ url_for('event', id=event.id) }}">{{ event.name }}</a></td>
	      	<td>{{ event.city|city_and_state_or_country }}</td>
		  	</tr>
			{% endfor %}
	  	</tbody>
	</table>
	{% endfor %}
	{% endfor %}
	{% else %}
	<p>No events.</p>
	{% endif %}
{% endblock %}